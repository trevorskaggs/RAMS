AWSTemplateFormatVersion: 2010-09-09

Description: Base resources for shelterly
Resources:

  # IAM Role that the API runs with

  LambdaIAMRole:
    Type: AWS::IAM::Role
    Properties:
      AssumeRolePolicyDocument:
        Version: 2012-10-17
        Statement:
        - Effect: Allow
          Principal:
            Service: lambda.amazonaws.com
          Action: sts:AssumeRole

  LambdaIAMRoleAllowLogging:
    Type: AWS::IAM::Policy
    Properties:
      Roles:
      - !Ref LambdaIAMRole
      PolicyName: AllowLogging
      PolicyDocument:
        Version: 2012-10-17
        Statement:
        - Effect: Allow
          Action:
          - logs:CreateLogGroup
          - logs:CreateLogStream
          - logs:PutLogEvents
          Resource:
          - !Sub arn:aws:logs:*:${AWS::AccountId}:log-group:/aws/lambda/*
          - !Sub arn:aws:logs:*:${AWS::AccountId}:log-group:/aws/lambda/*:*


Outputs:

  LambdaIAMRoleArn:
    Value: !GetAtt LambdaIAMRole.Arn

  PackageS3Bucket:
    Value: !Ref PackageS3Bucket
